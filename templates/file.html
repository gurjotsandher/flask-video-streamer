<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask WebSocket Streaming</title>
</head>
<body>
    <h1>Live Video Stream</h1>
    <div class="div">
        <img id="image1" alt="Live Stream" style="max-width: 100%; height: auto;">
    </div>

    <!-- Load Latest Socket.IO Client Library -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <script type="text/javascript">
        // Connect to the WebSocket server
        var socket = io.connect(window.location.origin, {
            transports: ['websocket', 'polling']
        });

        // Log connection status
        socket.on('connect', function() {
            console.log("Connected to WebSocket server.");
            socket.emit('check', { data: 'User Connected' });
        });

        // Handle incoming image stream
        socket.on('image', function(msg) {
            console.log("Received new frame.");
            const image_element = document.getElementById('image1');
            image_element.src = "data:image/jpeg;base64," + msg;
        });

        // Handle errors
        socket.on('connect_error', function(error) {
            console.error("Connection Error:", error);
        });

        socket.on('disconnect', function() {
            console.warn("Disconnected from WebSocket server.");
        });
    </script>
</body>
</html>
